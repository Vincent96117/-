<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>HUNTER PRO V132 | å¼·å‹¢ç›£æ§ç‰ˆ</title>
    <style>
        body { background: #000; color: #eee; font-family: 'Segoe UI', sans-serif; padding: 20px; font-size: 13px; }
        .dashboard { background: #1c1c1c; padding: 15px; border-radius: 8px; border: 1px solid #333; margin-bottom: 20px; display: flex; gap: 20px; align-items: center; justify-content: space-between; }
        .search-area { background: #252525; padding: 10px; border-radius: 6px; border: 1px solid #444; }
        input { background: #333; color: #fff; border: 1px solid #555; padding: 5px; border-radius: 4px; width: 100px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #333; padding: 8px; text-align: center; }
        th { background: #252525; color: #f2a900; position: sticky; top: 0; }
        
        /* ç‹€æ…‹é¡è‰² */
        .status-launch { background: #d97706; color: #fff; padding: 2px 5px; border-radius: 3px; font-weight: bold; animation: blink 0.8s infinite; }
        .status-tangle { color: #888; border: 1px solid #444; padding: 2px 5px; border-radius: 3px; }
        .funding-alert { background: #ff0000; color: #fff; font-weight: bold; padding: 2px 5px; border-radius: 3px; }
        
        .score-box { background: #444; color: #fff; padding: 3px 8px; border-radius: 3px; font-weight: bold; }
        .score-vip { background: linear-gradient(45deg, #f2a900, #ffcc00) !important; color: #000 !important; box-shadow: 0 0 10px #f2a900; }
        
        .up { color: #00ffcc; } .down { color: #ff6666; }
        .row-vip { background-color: rgba(242, 169, 0, 0.1) !important; }
        @keyframes blink { 50% { opacity: 0.3; } }
    </style>
</head>
<body>
    <h1>ğŸ¯ HUNTER PRO V132 (è©•åˆ† 70+ å¼·å‹¢ç›£æ§)</h1>
    
    <div class="dashboard">
        <div id="clock" style="font-size: 1.2em; color: #f2a900;">è¼‰å…¥ä¸­...</div>
        <div class="search-area">
            ğŸ” å€‹åˆ¥å¹£ç¨®æŸ¥è©¢ï¼š
            <input type="text" id="symbolInp" placeholder="ä¾‹å¦‚: SOL">
            <button onclick="manualCheck()" style="cursor:pointer">æŸ¥è©¢</button>
        </div>
        <div id="scanner-status">æ­£åœ¨éæ¿¾ 70 åˆ†ä»¥ä¸Šå¼·å‹¢å¹£...</div>
    </div>

    <table id="hunter-table">
        <thead>
            <tr>
                <th>å¹£ç¨®</th>
                <th>ç•¶å‰ç‹€æ…‹</th>
                <th>è©•åˆ†</th>
                <th>åƒ¹æ ¼</th>
                <th>24H æ¼²è·Œ</th>
                <th>æœ€é«˜/æœ€ä½</th>
                <th>è³‡è²» (Funding)</th>
                <th>ç³¾çµåº¦ %</th>
                <th>æˆäº¤é¡</th>
            </tr>
        </thead>
        <tbody id="hunter-body"></tbody>
    </table>

<script>
    const TANGLE_LIMIT = 1.5; 
    const MIN_SCORE = 70; // ä¿®æ”¹ï¼šåªé¡¯ç¤º 70 åˆ†ä»¥ä¸Šçš„å¹£

    async function updateData() {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        try {
            const [tRes, fRes] = await Promise.all([
                fetch('https://fapi.binance.com/fapi/v1/ticker/24hr'),
                fetch('https://fapi.binance.com/fapi/v1/premiumIndex')
            ]);
            const tData = await tRes.json();
            const fData = await fRes.json();
            
            // åˆæ­¥éæ¿¾æˆäº¤é‡
            const potentialSymbols = tData.filter(d => d.symbol.endsWith('USDT') && parseFloat(d.quoteVolume) > 8000000);

            const body = document.getElementById('hunter-body');
            let newRows = "";

            for (let item of potentialSymbols) {
                const s = item.symbol;
                
                // 1. å…ˆç®—åˆ†ï¼Œæ²’é 70 åˆ†çš„ç›´æ¥è·³éï¼Œä¸è·‘å‡ç·šé‹ç®—ä»¥ç¯€çœè³‡æº
                const range = ((parseFloat(item.highPrice) - parseFloat(item.lowPrice)) / parseFloat(item.lowPrice)) * 100;
                let score = Math.min(100, Math.round(range * 8 + 35));
                
                if (score < MIN_SCORE) continue; 

                // 2. åˆ†æ•¸å¤ äº†ï¼Œæ‰æŠ“ K ç·šç®—å‡ç·š
                const kRes = await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${s}&interval=5m&limit=100`);
                const k = await kRes.json();
                if (k.length < 99) continue;

                const closePrices = k.map(x => parseFloat(x[4]));
                const lastClose = closePrices[closePrices.length - 1];
                const lastOpen = parseFloat(k[k.length-1][1]);
                const ma7 = getMA(closePrices, 7);
                const ma25 = getMA(closePrices, 25);
                const ma99 = getMA(closePrices, 99);
                const tangleGap = ((Math.max(ma7,ma25,ma99) - Math.min(ma7,ma25,ma99)) / Math.min(ma7,ma25,ma99) * 100).toFixed(2);

                let statusHtml = "-";
                if (lastClose > ma7 && lastClose > ma25 && lastClose > ma99 && lastClose > lastOpen && tangleGap <= TANGLE_LIMIT) {
                    statusHtml = '<span class="status-launch">ğŸš€ å•Ÿå‹•çªç ´</span>';
                } else if (tangleGap <= TANGLE_LIMIT) {
                    statusHtml = '<span class="status-tangle">â³ å‡ç·šç³¾çµ</span>';
                }

                const fund = fData.find(f => f.symbol === s);
                const fundRate = fund ? (parseFloat(fund.lastFundingRate) * 100).toFixed(4) : "0.0000";
                const fundClass = Math.abs(parseFloat(fundRate)) >= 0.05 ? 'funding-alert' : '';
                const change = parseFloat(item.priceChangePercent);

                newRows += `
                    <tr class="${score >= 80 ? 'row-vip' : ''}">
                        <td style="font-weight:bold">${s.replace('USDT','')}</td>
                        <td>${statusHtml}</td>
                        <td><span class="score-box ${score >= 80 ? 'score-vip' : ''}">${score}</span></td>
                        <td style="font-weight:bold">${lastClose}</td>
                        <td class="${change >= 0 ? 'up' : 'down'}">${change}%</td>
                        <td style="font-size:11px">${item.highPrice} / ${item.lowPrice}</td>
                        <td><span class="${fundClass}">${fundRate}%</span></td>
                        <td class="${tangleGap <= 1 ? 'up' : ''}">${tangleGap}%</td>
                        <td>${(item.quoteVolume/1000000).toFixed(2)}M</td>
                    </tr>
                `;
            }
            body.innerHTML = newRows;
        } catch (e) { console.error(e); }
    }

    function getMA(prices, period) {
        return prices.slice(-period).reduce((a, b) => a + b) / period;
    }

    function manualCheck() {
        const s = document.getElementById('symbolInp').value.toUpperCase();
        if(s) window.open(`https://www.binance.com/zh-TC/futures/${s.includes('USDT')?s:s+'USDT'}`);
    }

    setInterval(updateData, 5000);
    updateData();
</script>
</body>
</html>
