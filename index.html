<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>HUNTER PRO | V115 çµ•å° 08:00 ç‰ˆ</title>
    <style>
        :root { --bg: #000; --card: #111; --border: #333; --text: #eee; --surge: #3fb950; --fall: #f85149; --strong: #58a6ff; --alert: #ff6600; --double: #f2a900; }
        body { background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; padding: 0; margin: 0; font-size: 11px; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        .top-calendar { height: 75px; border-bottom: 2px solid #444; display: flex; flex-direction: column; }
        .cal-header { background: #161b22; padding: 3px 10px; color: #888; display: flex; justify-content: space-between; border-bottom: 1px solid #333; }
        .cal-scroll { flex: 1; overflow-x: auto; display: flex; align-items: center; padding: 0 10px; gap: 20px; white-space: nowrap; }
        .header-main { display: flex; align-items: center; justify-content: space-between; background: #161b22; padding: 2px 12px; height: 30px; border-bottom: 1px solid var(--border); }
        .container { display: grid; grid-template-columns: 0.9fr 0.9fr 1.2fr 1.5fr; gap: 4px; flex: 1; padding: 4px; box-sizing: border-box; overflow: hidden; }
        .card { background: #0d1117; border: 1px solid var(--border); border-radius: 4px; display: flex; flex-direction: column; overflow: hidden; }
        h2 { font-size: 0.8rem; padding: 5px; margin: 0; background: #161b22; border-bottom: 1px solid var(--border); text-align: center; }
        .scroll { flex: 1; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; table-layout: fixed; }
        td { padding: 6px 2px; border-bottom: 1px solid #21262d; text-align: center; vertical-align: middle; }
        .up { color: var(--surge); font-weight: bold; } .down { color: var(--fall); font-weight: bold; }
        .win-row { background: #064e3b !important; } 
        .loss-row { background: #7f1d1d !important; }
        .snap-score { color: var(--alert); font-weight: bold; margin-right: 5px; }
        .snap-group { border-left: 3px solid #444; margin-bottom: 2px; background: #161b22; }
        .snap-title { background: #222; font-size: 10px; padding: 2px 5px; color: #aaa; font-weight: bold; }
    </style>
</head>
<body>

<div class="header-main">
    <div><span style="color:#f2a900">BTC: <span id="btc-live">--</span></span></div>
    <div style="color:var(--strong); font-weight:bold;">HUNTER PRO | V115 çµ•å° 08:00 ç‰ˆ</div>
    <button onclick="localStorage.clear(); location.reload();">ğŸ§¹ å¼·åˆ¶æ¸…é™¤å¿«å–ä¸¦åˆ·æ–°</button>
</div>

<div class="container">
    <div class="card"><h2 style="color:var(--surge)">ğŸš€ ç¬é–“å™´ç™¼</h2><div class="scroll"><table><tbody id="surge-list"></tbody></table></div></div>
    <div class="card"><h2 style="color:var(--strong)">ğŸ”¥ é«˜æª”å¼·å‹¢</h2><div class="scroll"><table><tbody id="strong-list"></tbody></table></div></div>
    <div class="card">
        <h2 style="color:var(--double)">â±ï¸ 08:00 åŸå§‹è©•åˆ† (ä»Šæ—¥é–å®š)</h2>
        <div id="snap-list" class="scroll"></div>
    </div>
    <div class="card">
        <h2 style="color:#bc8cff">ğŸ’ æ ¸å¿ƒç›£æ§</h2>
        <div class="scroll"><table id="table-old"></table></div>
    </div>
</div>

<script>
    let dataMap = {}, lockedSnapshot = [];

    // ğŸŸ¢ V115 æ ¸å¿ƒï¼šå¼·åˆ¶æŠ“å–ä»Šæ—¥æ—¥ç·šï¼Œæ’é™¤ 24hr æ»¾å‹•èª¤å·®
    async function initSnapshot() {
        try {
            const t = new Date().getTime();
            // 1. ç²åˆ©äº¤æ˜“å°
            const exRes = await fetch(`https://fapi.binance.com/fapi/v1/ticker/24hr?t=${t}`);
            const allData = await exRes.json();
            
            // 2. åªéæ¿¾å‡º USDT åˆç´„å¹£ç¨®
            const targets = allData.filter(d => d.symbol.endsWith('USDT')).slice(0, 100); // æ‹¿å‰ 100 éš»æœ‰é‡çš„

            lockedSnapshot = targets.map(d => {
                const s = d.symbol.replace('USDT','');
                const open = parseFloat(d.openPrice); // å¹£å®‰ API çš„ openPrice å›ºå®šç‚º UTC 00:00 (å°åŒ— 08:00)
                const last = parseFloat(d.lastPrice);
                const p24 = parseFloat(d.priceChangePercent);
                const vol = parseFloat(d.quoteVolume);
                
                // å®šæ ¼ 08:00 åˆ†æ•¸
                let score = (vol > 8000000) ? Math.min(100, Math.round((p24 * 10) + 30)) : 0;
                
                if(!dataMap[s]) dataMap[s] = {lp: last};
                return { s, open, score };
            }).filter(x => x.score >= 40).sort((a,b) => b.score - a.score);

            renderSnapshot();
        } catch (e) { console.error("Snapshot Error"); }
    }

    function renderSnapshot() {
        const container = document.getElementById('snap-list');
        container.innerHTML = '';
        let h = `<div class="snap-group"><table>`;
        lockedSnapshot.forEach(it => {
            const cur = dataMap[it.s]?.lp || it.open;
            const diff = ((cur - it.open) / it.open * 100).toFixed(2);
            let rowClass = (diff >= 10) ? 'win-row' : (diff <= -10 ? 'loss-row' : '');
            h += `<tr class="${rowClass}"><td style="text-align:left;padding-left:5px;"><span class="snap-score">${it.score}</span>${it.s}</td><td>${it.open.toFixed(4)}â†’${cur.toFixed(4)}</td><td class="${diff>0?'up':'down'}">${diff}%</td></tr>`;
        });
        container.innerHTML = h + `</table></div>`;
    }

    function connectWS() {
        const ws = new WebSocket('wss://stream.binance.com:9443/ws/!ticker@arr');
        ws.onmessage = (e) => {
            const tickers = JSON.parse(e.data);
            tickers.forEach(d => {
                const s = d.s.replace('USDT','');
                if(!d.s.endsWith('USDT')) return;
                const p = parseFloat(d.c);
                if(dataMap[s]) dataMap[s].lp = p;
                if(s === 'BTC') document.getElementById('btc-live').innerText = p;
            });
            renderSnapshot();
        };
    }

    initSnapshot(); connectWS();
</script>
</body>
</html>
