<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>HUNTER PRO V133 | æ ¸å¿ƒé‡èƒ½å•Ÿå‹•ç›£æ§</title>
    <style>
        body { background: #000; color: #eee; font-family: 'Segoe UI', sans-serif; padding: 20px; font-size: 13px; }
        .dashboard { background: #1c1c1c; padding: 15px; border-radius: 8px; border: 1px solid #333; margin-bottom: 20px; display: flex; gap: 15px; align-items: center; justify-content: space-between; }
        .dashboard-left { display: flex; align-items: center; gap: 20px; }
        .filter-ctrl { background: #252525; padding: 8px 15px; border-radius: 6px; border: 1px solid #f2a900; display: flex; align-items: center; gap: 10px; font-weight: bold; }
        .search-area { background: #252525; padding: 8px 15px; border-radius: 6px; border: 1px solid #444; }
        input[type="text"] { background: #333; color: #fff; border: 1px solid #555; padding: 5px; border-radius: 4px; width: 80px; }
        button { background: #444; color: #fff; border: 1px solid #666; padding: 5px 12px; cursor: pointer; border-radius: 4px; }
        button:hover { background: #555; }

        /* æ»‘å‹•é–‹é—œ UI */
        .switch { position: relative; display: inline-block; width: 34px; height: 18px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #555; transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 12px; width: 12px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #f2a900; }
        input:checked + .slider:before { transform: translateX(16px); }

        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #333; padding: 8px; text-align: center; }
        th { background: #252525; color: #f2a900; position: sticky; top: 0; z-index: 10; }
        
        /* ç‹€æ…‹æ¨£å¼ */
        .status-launch { background: #d97706; color: #fff; padding: 2px 6px; border-radius: 3px; font-weight: bold; animation: blink 0.8s infinite; }
        .status-tangle { color: #888; border: 1px solid #444; padding: 2px 6px; border-radius: 3px; }
        .funding-alert { background: #ff0000; color: #fff; font-weight: bold; padding: 2px 5px; border-radius: 3px; }
        .score-box { background: #444; color: #fff; padding: 3px 8px; border-radius: 3px; font-weight: bold; border: 1px solid #555; }
        .score-vip { background: linear-gradient(45deg, #f2a900, #ffcc00) !important; color: #000 !important; box-shadow: 0 0 10px rgba(242,169,0,0.5); border: none !important; }
        
        .up { color: #00ffcc; } .down { color: #ff6666; }
        .row-vip { background-color: rgba(242, 169, 0, 0.08) !important; }
        @keyframes blink { 50% { opacity: 0.4; } }
    </style>
</head>
<body>
    <h1>ğŸ¯ HUNTER PRO V133</h1>
    
    <div class="dashboard">
        <div class="dashboard-left">
            <div id="clock" style="font-size: 1.1em; color: #f2a900; min-width: 80px;">00:00:00</div>
            <div class="filter-ctrl">
                <span>é¡¯ç¤ºç³¾çµå¹£</span>
                <label class="switch">
                    <input type="checkbox" id="showTangle" checked>
                    <span class="slider"></span>
                </label>
            </div>
        </div>

        <div class="search-area">
            ğŸ” å¿«é€ŸæŸ¥åˆ†ï¼š<input type="text" id="symbolInp" placeholder="ä¾‹å¦‚: SOL">
            <button onclick="manualCheck()">è¨ºæ–·</button>
        </div>
    </div>

    <table id="hunter-table">
        <thead>
            <tr>
                <th>å¹£ç¨®</th>
                <th>ç‹€æ…‹</th>
                <th>é‡èƒ½è©•åˆ†</th>
                <th>ç•¶å‰åƒ¹æ ¼</th>
                <th>24H æ¼²è·Œ</th>
                <th>æœ€é«˜ / æœ€ä½</th>
                <th>è³‡è²» (Funding)</th>
                <th>ç³¾çµå¯¬åº¦%</th>
                <th>24H æˆäº¤é¡</th>
            </tr>
        </thead>
        <tbody id="hunter-body"></tbody>
    </table>

    <audio id="alertSound" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>

<script>
    const TANGLE_LIMIT = 1.5; 
    const MIN_SCORE = 70; 

    async function updateData() {
        document.getElementById('clock').innerText = new Date().toLocaleTimeString();
        const showTangle = document.getElementById('showTangle').checked;

        try {
            const [tRes, fRes] = await Promise.all([
                fetch('https://fapi.binance.com/fapi/v1/ticker/24hr'),
                fetch('https://fapi.binance.com/fapi/v1/premiumIndex')
            ]);
            const tData = await tRes.json();
            const fData = await fRes.json();
            
            // éæ¿¾æˆäº¤é¡ > 800M ä¸”ç‚º USDT åˆç´„
            const potentialSymbols = tData.filter(d => d.symbol.endsWith('USDT') && parseFloat(d.quoteVolume) > 8000000);
            const body = document.getElementById('hunter-body');
            let htmlRows = "";

            for (let item of potentialSymbols) {
                const s = item.symbol;
                
                // 1. æ ¸å¿ƒè©•åˆ†è¨ˆç®—
                const range = ((parseFloat(item.highPrice) - parseFloat(item.lowPrice)) / parseFloat(item.lowPrice)) * 100;
                let score = Math.min(100, Math.round(range * 8 + 35));
                if (score < MIN_SCORE) continue; 

                // 2. æŠ“å– 5m Kç·šç®— 7/25/99 å‡ç·š
                const kRes = await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${s}&interval=5m&limit=100`);
                const k = await kRes.json();
                if (k.length < 99) continue;

                const closePrices = k.map(x => parseFloat(x[4]));
                const lastClose = closePrices[closePrices.length - 1];
                const lastOpen = parseFloat(k[k.length-1][1]);
                
                const ma7 = getMA(closePrices, 7);
                const ma25 = getMA(closePrices, 25);
                const ma99 = getMA(closePrices, 99);
                
                const maxMA = Math.max(ma7, ma25, ma99);
                const minMA = Math.min(ma7, ma25, ma99);
                const tangleGap = ((maxMA - minMA) / minMA * 100).toFixed(2);

                const isLaunched = (lastClose > ma7 && lastClose > ma25 && lastClose > ma99 && lastClose > lastOpen && tangleGap <= TANGLE_LIMIT);
                const isTangled = (tangleGap <= TANGLE_LIMIT);

                // æ ¹æ“šé–‹é—œé‚è¼¯éæ¿¾
                if (!showTangle && !isLaunched) continue;
                if (!isTangled && !isLaunched) continue;

                // 3. ç²å–è³‡è²»èˆ‡å…¶ä»–æ•¸æ“š
                const fund = fData.find(f => f.symbol === s);
                const fundRate = fund ? (parseFloat(fund.lastFundingRate) * 100).toFixed(4) : "0.0000";
                const fundClass = Math.abs(parseFloat(fundRate)) >= 0.05 ? 'funding-alert' : '';
                const change = parseFloat(item.priceChangePercent);

                let statusHtml = isLaunched ? '<span class="status-launch">ğŸš€ å•Ÿå‹•çªç ´</span>' : '<span class="status-tangle">â³ å‡ç·šç³¾çµ</span>';
                if (isLaunched) playAlertOnce(s);

                htmlRows += `
                    <tr class="${score >= 80 ? 'row-vip' : ''}">
                        <td style="font-weight:bold">${s.replace('USDT','')}</td>
                        <td>${statusHtml}</td>
                        <td><span class="score-box ${score >= 80 ? 'score-vip' : ''}">${score}</span></td>
                        <td style="font-weight:bold; color:#f2a900">${lastClose}</td>
                        <td class="${change >= 0 ? 'up' : 'down'}">${change}%</td>
                        <td style="font-size:11px; color:#aaa">${item.highPrice} / ${item.lowPrice}</td>
                        <td><span class="${fundClass}">${fundRate}%</span></td>
                        <td class="${tangleGap <= 1 ? 'up' : ''}">${tangleGap}%</td>
                        <td>${(item.quoteVolume/1000000).toFixed(2)}M</td>
                    </tr>
                `;
            }
            body.innerHTML = htmlRows;
        } catch (e) { console.error("Update Error:", e); }
    }

    function getMA(prices, period) {
        return prices.slice(-period).reduce((a, b) => a + b) / period;
    }

    let lastAlerted = "";
    function playAlertOnce(s) {
        if (lastAlerted !== s) {
            document.getElementById('alertSound').play().catch(()=>{});
            lastAlerted = s;
        }
    }

    function manualCheck() {
        const s = document.getElementById('symbolInp').value.toUpperCase();
        if(s) window.open(`https://www.binance.com/zh-TC/futures/${s.includes('USDT')?s:s+'USDT'}`);
    }

    setInterval(updateData, 5000);
    updateData();
</script>
</body>
</html>
