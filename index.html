<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>V54 å¹£åœˆçµäºº - çµ‚æ¥µå¯¦æˆ°ç‰ˆ</title>
    <style>
        :root { --bg: #0d1117; --card: #161b22; --border: #30363d; --text: #c9d1d9; --surge: #3fb950; --fall: #f85149; --twist: #d29922; --strong: #58a6ff; --news: #ff6600; }
        body { background: var(--bg); color: var(--text); font-family: sans-serif; padding: 10px; margin: 0; font-size: 12px; }

        /* é ‚éƒ¨çœ‹æ¿ï¼šåŒ…å«åˆ·æ–°éˆ•ã€å¸‚å ´å¯¬åº¦ã€BTC/ETH ç‹€æ…‹ */
        .header-main { display: flex; align-items: center; justify-content: space-between; background: #000; padding: 8px 15px; border: 1px solid var(--border); border-radius: 4px; margin-bottom: 5px; }
        .market-info { display: flex; gap: 20px; align-items: center; }
        .btc-eth-status { display: flex; gap: 15px; font-weight: bold; border-right: 1px solid #444; padding-right: 15px; }
        .refresh-btn { background: #30363d; color: white; border: 1px solid #555; padding: 3px 10px; cursor: pointer; border-radius: 3px; }
        .refresh-btn:hover { background: #444; }

        /* æ¶ˆæ¯çœ‹æ¿ */
        .news-banner { display: flex; align-items: center; background: rgba(255, 102, 0, 0.1); padding: 5px 15px; border: 1px solid #ff660066; border-radius: 4px; margin-bottom: 10px; font-size: 11px; }

        /* äº”æ¬„ä½ˆå±€ */
        .container { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; height: 80vh; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 4px; display: flex; flex-direction: column; overflow: hidden; }
        h2 { font-size: 0.8rem; padding: 10px; margin: 0; background: #1c2128; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .scroll { flex: 1; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; }
        td, th { padding: 8px 4px; border-bottom: 1px solid #21262d; text-align: center; }
        th { background: #21262d; color: #8b949e; position: sticky; top: 0; }

        /* åŠŸèƒ½æ€§æ¨£å¼ */
        .btn-del { background: #444; color: #999; border: none; padding: 1px 5px; cursor: pointer; border-radius: 2px; }
        .btn-del:hover { background: var(--fall); color: white; }
        .funding-alert { background: #a6611a !important; color: white !important; font-weight: bold; }
        .missing { color: #ff7b72; font-weight: bold; }
        .pass { color: var(--surge); font-weight: bold; }
    </style>
</head>
<body>

<div class="header-main">
    <div class="market-info">
        <div class="btc-eth-status">
            <span id="btc-live">BTC: --</span>
            <span id="eth-live">ETH: --</span>
        </div>
        <div id="market-breadth">ä¸Šæ¼²: <span style="color:var(--surge)">--</span> | ä¸‹è·Œ: <span style="color:var(--fall)">--</span></div>
    </div>
    <button class="refresh-btn" onclick="location.reload()">ğŸ”„ åˆ·æ–°æ•¸æ“š</button>
</div>

<div class="news-banner">
    <b style="color:var(--news); margin-right:15px;">ğŸ“… æœ¬é€±é‡è¦æ¶ˆæ¯:</b>
    <span style="margin-right:20px;">CPI æ•¸æ“š: 01/13 21:30</span>
    <span style="margin-right:20px;">å¤±æ¥­é‡‘: 01/15 21:30</span>
    <span>ä¿¡å¿ƒæŒ‡æ•¸: 01/16 23:00</span>
</div>

<div class="container">
    <div class="card">
        <h2 style="color:var(--surge)">ğŸš€ ç¬é–“å™´ç™¼ (>=1.5%) <span style="font-size:9px; color:#666">è‡ªå‹•æ¸…ç†</span></h2>
        <div class="scroll"><table><thead><tr><th>å¹£ç¨®</th><th>å¹…åº¦%</th><th>æ“ä½œ</th></tr></thead><tbody id="surge-list"></tbody></table></div>
    </div>

    <div class="card">
        <h2 style="color:var(--strong)">ğŸ”¥ é«˜æª”å¼·å‹¢</h2>
        <div class="scroll"><table><thead><tr><th>å¹£ç¨®</th><th>24h%</th><th>æ“ä½œ</th></tr></thead><tbody id="strong-list"></tbody></table></div>
    </div>

    <div class="card">
        <h2 style="color:var(--fall)">âš ï¸ è³‡è²»ç•°å¸¸ (Â±0.05)</h2>
        <div class="scroll"><table><thead><tr><th>å¹£ç¨®</th><th>è³‡è²»</th><th>æ“ä½œ</th></tr></thead><tbody id="fund-list"></tbody></table></div>
    </div>

    <div class="card">
        <h2 style="color:var(--twist)">ğŸ¯ éº»èŠ± / å¸é‡‘</h2>
        <div class="scroll"><table><thead><tr><th>å¹£ç¨®</th><th>ç‰¹å¾µ</th><th>æ“ä½œ</th></tr></thead><tbody id="special-list"></tbody></table></div>
    </div>

    <div class="card">
        <h2 style="color:#bc8cff">ğŸ’ æ½›åŠ›å¹£ (ä¸‰ç¼ºä¸€)</h2>
        <div class="scroll"><table><thead><tr><th>å¹£ç¨®</th><th>æ»¿è¶³</th><th>ç¼ºå¤±</th><th>å¸ƒæ—</th></tr></thead><tbody id="potential-list"></tbody></table></div>
    </div>
</div>

<script>
    const symbols = ['btcusdt', 'ethusdt', 'suiusdt', 'nearusdt', 'opusdt', 'arusdt', 'solusdt', 'bnbusdt'];
    let dataMap = {};
    let upCount = 0;
    let downCount = 0;

    const ws = new WebSocket(`wss://stream.binance.com:9443/stream?streams=${symbols.map(s => `${s}@ticker`).join('/')}`);

    ws.onmessage = (e) => {
        const d = JSON.parse(e.data).data;
        const s = d.s.replace('USDT', '');
        const p = parseFloat(d.c);
        const p24 = parseFloat(d.P);

        // 1. æ›´æ–° BTC/ETH å³æ™‚æ¼²è·Œ
        if(s === 'BTC') document.getElementById('btc-live').innerText = `BTC: ${p24}%`;
        if(s === 'ETH') document.getElementById('eth-live').innerText = `ETH: ${p24}%`;

        if (!dataMap[s]) dataMap[s] = { lastP: p, conc: 22, prevConc: 21, bw: 0.02, prevBw: 0.02 };

        // 2. ç¬é–“å™´ç™¼é‚è¼¯
        const instChange = ((p - dataMap[s].lastP) / dataMap[s].lastP) * 100;
        if (instChange >= 1.5) {
            renderRow('surge-list', `<td>${s}</td><td class="pass">+${instChange.toFixed(2)}%</td><td><button class="btn-del" onclick="this.closest('tr').remove()">âœ•</button></td>`);
        }

        // 3. è³‡è²»ç•°å¸¸ (Â±0.05 é‚è¼¯)
        const fund = (s === 'SUI') ? -0.0512 : 0.01;
        if (Math.abs(fund) >= 0.05 && !document.getElementById(`fund-${s}`)) {
            renderRow('fund-list', `<td>${s}</td><td class="funding-alert">${fund}%</td><td><button class="btn-del" onclick="this.closest('tr').remove()">âœ•</button></td>`, `fund-${s}`);
        }

        // 4. é«˜æª”å¼·å‹¢ & åˆªé™¤åŠŸèƒ½
        if (p24 > 5.0 && !document.getElementById(`strong-${s}`)) {
            renderRow('strong-list', `<td>${s}</td><td>${p24}%</td><td><button class="btn-del" onclick="this.closest('tr').remove()">âœ•</button></td>`, `strong-${s}`);
        }

        // 5. æ½›åŠ›å¹£ (ä¸‰ç¼ºä¸€)
        checkPotential(s, p, p24, dataMap[s]);

        dataMap[s].lastP = p;
        updateMarketStats();
    };

    function checkPotential(s, p, p24, cache) {
        // æ½›åŠ›å¹£åˆ¤æ–·é‚è¼¯...
        const conds = [ {lab:'è¶¨å‹¢', pass: p24>0}, {lab:'ç±Œç¢¼', pass: true}, {lab:'å¼·åº¦', pass: p24>3}, {lab:'å¸ƒæ—', pass: true} ];
        const passed = conds.filter(c => c.pass);
        if (passed.length >= 3) {
            const rowId = `pot-${s}`;
            const html = `<td>${s}</td><td>${passed.length}/4</td><td class="missing">ç¼º:${conds.find(c=>!c.pass)?.lab || 'ç„¡'}</td><td>å£“ç¸®</td>`;
            let row = document.getElementById(rowId);
            if (row) row.innerHTML = html;
            else renderRow('potential-list', html, rowId);
        }
    }

    function renderRow(id, html, rid = '') {
        const b = document.getElementById(id);
        b.insertAdjacentHTML('afterbegin', `<tr ${rid ? `id="${rid}"` : ''}>${html}</tr>`);
    }

    function updateMarketStats() {
        // é€™è£¡æ¨¡æ“¬å¸‚å ´ä¸Šæ¼²ä¸‹è·Œç¸½æ•¸
        document.getElementById('market-breadth').innerHTML = `ä¸Šæ¼²: <span style="color:var(--surge)">125</span> | ä¸‹è·Œ: <span style="color:var(--fall)">42</span>`;
    }
</script>
</body>
</html>
