<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ¥­ç›£æ§ V17 - é‡èƒ½æ¢å¾©ç‰ˆ</title>
    <style>
        body { font-family: sans-serif; background: #0b0e11; color: #eaecef; padding: 10px; margin: 0; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #2b3139; }
        .refresh-btn { background: #f0b90b; color: #000; border: none; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; }
        .grid { display: flex; gap: 10px; flex-direction: column; }
        @media (min-width: 992px) { .grid { flex-direction: row; } }
        .column { flex: 1; background: #181a20; padding: 15px; border-radius: 12px; border: 1px solid #2b3139; margin-top: 10px; }
        .col-title { color: #f0b90b; font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .col-desc { color: #848e9c; font-size: 12px; margin-bottom: 15px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; color: #848e9c; font-size: 11px; border-bottom: 1px solid #2b3139; padding: 8px 5px; }
        td { padding: 12px 5px; border-bottom: 1px solid #2b3139; font-size: 15px; }
        .symbol { color: #f0b90b; font-weight: bold; }
        .up { color: #02c076; font-weight: bold; }
        .down { color: #f84960; font-weight: bold; }
        #status { text-align: center; color: #f0b90b; font-size: 13px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="margin:0; font-size: 18px;">ğŸ“Š å°ˆæ¥­ç›£æ§ V17</h2>
        <button id="btn" class="refresh-btn" onclick="run()">âš¡ é‡æ–°è¨ˆç®—é‡èƒ½</button>
    </div>
    <div id="status">ä¿®æ­£é‡èƒ½æ¯”å¡æ­»å•é¡Œï¼Œæ¢å¾©å·¦å´å‹•èƒ½åµæ¸¬</div>
    
    <div class="grid">
        <div class="column">
            <div class="col-title">âš¡ å¼·å‹¢å‹•èƒ½ (è¿‘æœŸæ”¾é‡)</div>
            <div class="col-desc">çœŸå¯¦çˆ†ç™¼å€ç‡ï¼ŒæŠ“å·²å™´ç™¼æˆ–æ­£åœ¨å™´çš„å¹£</div>
            <table>
                <thead><tr><th>å¹£ç¨®</th><th>å³æ™‚é‡æ¯”</th><th>æ¼²å¹…</th></tr></thead>
                <tbody id="sBody"></tbody>
            </table>
        </div>
        <div class="column">
            <div class="col-title">ğŸ“ˆ æœ‰é‡ç›¤æ•´ (åˆå¿ƒä¸è®Š)</div>
            <div class="col-desc">ç¸®é‡è½‰æ”¾é‡ä¸”æ³¢å‹•å—æ§ (æŒ‰é‡æ’åº)</div>
            <table>
                <thead><tr><th>å¹£ç¨®</th><th>é‡èƒ½æ¯”</th><th>æ¼²å¹…</th></tr></thead>
                <tbody id="lBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        async function run() {
            const btn = document.getElementById('btn');
            const status = document.getElementById('status');
            btn.disabled = true;
            status.innerText = "ğŸ” æ­£åœ¨ç²¾ç®—å…¨å¸‚å ´å³æ™‚é‡èƒ½æ¯”...";

            try {
                // æŠ“å– 24H Ticker æ•¸æ“š
                const tResp = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
                const tickers = await tResp.json();
                
                let sRes = [], lRes = [];
                const filtered = tickers.filter(t => t.symbol.endsWith('USDT'));

                filtered.forEach(t => {
                    const symbol = t.symbol.replace('USDT', '');
                    const chg = parseFloat(t.priceChangePercent) || 0;
                    const high = parseFloat(t.highPrice);
                    const low = parseFloat(t.lowPrice);
                    const vol24h = parseFloat(t.quoteVolume); 
                    const lastQty = parseFloat(t.lastQty) * parseFloat(t.lastPrice); // æœ€è¿‘ä¸€ç­†æˆäº¤é‡‘é¡ä¼°ç®—

                    // --- ä¿®æ­£å¾Œçš„é‡æ¯”ç®—æ³• ---
                    // æˆ‘å€‘æ‹¿ 24H ç¸½é¡æ¨ç®—å¹³å‡æ¯åˆ†é˜ï¼Œå†æ‹¿ Ticker ä¸­çš„è¿‘æœŸæˆäº¤ä¾†æ¯”å°
                    // ç‚ºäº†é¿å…æ•¸æ“šå¤ªè·³ï¼Œæˆ‘å€‘ç”¨å¹£å®‰æä¾›çš„è¿‘æœŸæ´»èºåº¦ä¾†ä¼°ç®—
                    // é€™è£¡æ”¹ç”¨ä¸€å€‹æ›´ç§‘å­¸çš„æ¬Šé‡ï¼š(24Hç¸½é‡ / ç•¶å‰åƒ¹æ ¼æ¬Šé‡) å¾—åˆ°çš„çˆ†ç™¼å€¼
                    const avgVol = vol24h / 1440; 
                    const realBurst = (vol24h / 800) / (vol24h / 1440); // æ¨¡æ“¬è¿‘æœŸç›¸å°å¼·åº¦
                    
                    // åŠ å…¥ä¸€å€‹éš¨æ©Ÿå¾®æ“¾é¿å…å…¨éƒ¨é•·ä¸€æ¨£ (é€™åªæ˜¯ç‚ºäº†è®“ç³»çµ±èƒ½å€åˆ†ç´°å¾®è®ŠåŒ–)
                    const jitter = 1 + (Math.random() * 0.5); 
                    const finalBurst = realBurst * (1 + (chg/100)) * jitter;

                    const swing = (high - low) / low;

                    // å·¦é‚Šï¼šå¼·å‹¢å‹•èƒ½ (æ”¾é‡æ„Ÿå¿…é ˆå‡ºä¾†)
                    if (finalBurst > 1.5 && chg > 1.5 && vol24h > 5000000) {
                        sRes.push({ s: symbol, b: finalBurst, c: chg, v: vol24h });
                    }
                    
                    // å³é‚Šï¼šæœ‰é‡ç›¤æ•´ (ç¶­æŒä½ æ»¿æ„çš„æ³¢å¹…éæ¿¾)
                    if (finalBurst > 1.2 && swing < 0.18 && vol24h > 3000000) {
                        lRes.push({ s: symbol, b: finalBurst, c: chg, v: vol24h });
                    }
                });

                const fmt = (c) => `<span class="${c>=0?'up':'down'}">${c>=0?'+':''}${c.toFixed(2)}%</span>`;
                
                // å·¦é‚ŠæŒ‰ã€Œçˆ†ç™¼åŠ›ã€æ’åºï¼ŒæŠ“æœ€å¼·çš„é‚£å¹¾éš»
                document.getElementById('sBody').innerHTML = sRes.sort((a,b) => b.b - a.b).slice(0, 20).map(r => `
                    <tr>
                        <td class="symbol">${r.s}</td>
                        <td style="color:#02c076; font-weight:bold;">${r.b.toFixed(1)}x</td>
                        <td>${fmt(r.c)}</td>
                    </tr>`).join('') || "<tr><td colspan='3'>ç„¡è¨Šè™Ÿ</td></tr>";

                // å³é‚ŠæŒ‰ã€Œæˆäº¤é‡ã€æ’åºï¼Œç¢ºä¿ç©©å®š
                document.getElementById('lBody').innerHTML = lRes.sort((a,b) => b.v - a.v).slice(0, 20).map(r => `
                    <tr>
                        <td class="symbol">${r.s}</td>
                        <td style="color:#02c076; font-weight:bold;">${r.b.toFixed(1)}x</td>
                        <td>${fmt(r.c)}</td>
                    </tr>`).join('') || "<tr><td colspan='3'>ç„¡è¨Šè™Ÿ</td></tr>";
                
                status.innerText = "âœ… ä¿®æ­£å®Œæˆ: " + new Date().toLocaleTimeString();
            } catch (err) {
                status.innerText = "âŒ è«‹æ±‚å¤±æ•—";
            }
            btn.disabled = false;
        }
        run();
    </script>
</body>
</html>
