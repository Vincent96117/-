<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡èƒ½ç›£æ§-é€£ç·šä¿®å¾©ç‰ˆ</title>
    <style>
        body { font-family: sans-serif; background: #0b0e11; color: #eaecef; padding: 10px; margin: 0; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #2b3139; }
        .refresh-btn { background: #f0b90b; color: #000; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .grid { display: flex; gap: 10px; flex-direction: column; }
        @media (min-width: 992px) { .grid { flex-direction: row; } }
        .column { flex: 1; background: #181a20; padding: 12px; border-radius: 12px; border: 1px solid #2b3139; margin-top: 10px; }
        .col-title { color: #f0b90b; font-size: 16px; font-weight: bold; margin-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; color: #848e9c; font-size: 11px; border-bottom: 1px solid #2b3139; padding: 5px; }
        td { padding: 10px 5px; border-bottom: 1px solid #2b3139; font-size: 14px; }
        .symbol { color: #f0b90b; font-weight: bold; }
        .up { color: #02c076; }
        .down { color: #f84960; }
        #status { text-align: center; color: #f0b90b; font-size: 13px; padding: 10px; background: #2b3139; border-radius: 5px; margin: 5px 0; }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="margin:0; font-size: 18px;">ğŸ“Š å°ˆæ¥­é‡èƒ½ç›£æ§</h2>
        <button id="btn" class="refresh-btn" onclick="run()">âš¡ é‡æ–°é€£æ¥</button>
    </div>
    <div id="status">æª¢æŸ¥é€£ç·šä¸­...</div>
    
    <div class="grid">
        <div class="column">
            <div class="col-title">âš¡ çŸ­ç·šçˆ†ç™¼ (30M)</div>
            <table>
                <thead><tr><th>å¹£ç¨®</th><th>é‡æ¯”</th><th>æ¼²å¹…</th></tr></thead>
                <tbody id="sBody"></tbody>
            </table>
        </div>
        <div class="column">
            <div class="col-title">ğŸ§ª æ½›åŠ›å¸ç±Œ (8H)</div>
            <table>
                <thead><tr><th>å¹£ç¨®</th><th>é‡æ¯”</th><th>æ¼²å¹…</th></tr></thead>
                <tbody id="lBody"></tbody>
            </table>
        </div>
    </div>

    <script>
        async function run() {
            const btn = document.getElementById('btn');
            const status = document.getElementById('status');
            btn.disabled = true;
            status.innerText = "æ­£åœ¨å˜—è©¦é€£æ¥å¹£å®‰å‚™ç”¨ä¼ºæœå™¨...";

            // ä½¿ç”¨å‚™ç”¨ API åŸŸåï¼šbinance.me æˆ– binance.com
            const endpoints = [
                'https://fapi.binance.com/fapi/v1/ticker/24hr',
                'https://fapi.binance.me/fapi/v1/ticker/24hr'
            ];

            let data = null;
            for (let url of endpoints) {
                try {
                    const resp = await fetch(url, { method: 'GET' });
                    if (resp.ok) {
                        data = await resp.json();
                        break; 
                    }
                } catch (e) {
                    console.log("å˜—è©¦ " + url + " å¤±æ•—");
                }
            }

            if (!data) {
                status.innerText = "âŒ é€£ç·šå¤±æ•—ï¼è«‹é—œé–‰ VPN æˆ–åˆ‡æ›æ‰‹æ©Ÿç¶²è·¯ (4G/5G)";
                btn.disabled = false;
                return;
            }

            status.innerText = "ğŸš€ é€£æ¥æˆåŠŸï¼Œéæ¿¾æ•¸æ“šä¸­...";

            let sRes = [], lRes = [];
            const usdtPairs = data.filter(t => t.symbol.endsWith('USDT'));

            usdtPairs.forEach(t => {
                const symbol = t.symbol.replace('USDT', '');
                const chg = parseFloat(t.priceChangePercent);
                const curPrice = parseFloat(t.lastPrice);
                const high = parseFloat(t.highPrice);
                const low = parseFloat(t.lowPrice);
                const vol = parseFloat(t.quoteVolume); // æˆäº¤é¡

                // è¨ˆç®—é‡æ¯” (ç°¡åŒ–é‚è¼¯ï¼šæŠ“ç•¶å‰æˆäº¤é¡å‰ 50% ä¸”æœ‰ç•°å‹•çš„)
                const pricePos = (curPrice - low) / (high - low);

                // å·¦é‚Šï¼šçˆ†ç™¼å¹£ (ä»Šæ—¥æ¼²å¹… > 5% ä¸”å¸¶é‡)
                if (chg > 5 && vol > 10000000) { 
                    sRes.push({ s: symbol, r: 2.5, c: chg, v: vol }); 
                }
                
                // å³é‚Šï¼šå¸ç±Œå¹£ (åƒ¹æ ¼åœ¨ä½ä½ < 35%ï¼Œæ¼²å¹… 0.5~4% ä¹‹é–“ï¼Œä¸”æœ‰åŸºç¤æˆäº¤é¡)
                if (pricePos < 0.35 && chg > 0.5 && chg < 4 && vol > 5000000) {
                    lRes.push({ s: symbol, r: 1.8, c: chg, v: vol });
                }
            });

            const fmt = (c) => `<span class="${c>=0?'up':'down'}">${c>=0?'+':''}${c.toFixed(2)}%</span>`;
            const render = (arr) => arr.sort((a,b) => b.v - a.v).slice(0, 15).map(r => `
                <tr>
                    <td class="symbol">${r.s}</td>
                    <td style="color:#02c076; font-weight:bold;">å¸¶é‡</td>
                    <td>${fmt(r.c)}</td>
                </tr>`).join('');

            document.getElementById('sBody').innerHTML = render(sRes) || "<tr><td colspan='3'>å¸‚å ´æš«ç„¡æš´å‹•</td></tr>";
            document.getElementById('lBody').innerHTML = render(lRes) || "<tr><td colspan='3'>å°šç„¡åº•éƒ¨å¸ç±Œ</td></tr>";
            
            status.innerText = "âœ… æ›´æ–°å®Œæˆï¼æœ€å¾Œæª¢æŸ¥æ™‚é–“: " + new Date().toLocaleTimeString();
            btn.disabled = false;
        }
        run();
    </script>
</body>
</html>
