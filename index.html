<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>é‡èƒ½ç›£æ§ V32 - çœŸå¯¦ 1% å™´ç™¼ä¿®æ­£ç‰ˆ</title>
    <style>
        body { font-family: sans-serif; background: #0b0e11; color: #eaecef; padding: 10px; margin: 0; }
        .header { display: flex; justify-content: space-between; align-items: center; padding: 10px; border-bottom: 1px solid #2b3139; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 10px; margin-top: 10px; }
        .column { background: #181a20; padding: 15px; border-radius: 12px; border: 1px solid #2b3139; min-height: 450px; }
        .col-title { color: #f0b90b; font-size: 16px; font-weight: bold; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        td { padding: 12px 5px; border-bottom: 1px solid #2b3139; font-size: 14px; }
        .symbol { color: #f0b90b; font-weight: bold; }
        .up { color: #02c076; font-weight: bold; }
        .down { color: #f84960; }
        .real-flash { background: rgba(2, 192, 118, 0.3); animation: flash 1s; }
        @keyframes flash { from { background: rgba(2, 192, 118, 0.5); } to { background: transparent; } }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="margin:0;">ğŸ“Š å°ˆæ¥­ç›£æ§ V32 (ä¿®æ­£ 1% çœŸå¯¦å™´ç™¼)</h2>
        <div id="timer" style="color:#848e9c;">5s åˆ·æ–°</div>
    </div>
    
    <div class="grid">
        <div class="column">
            <div class="col-title">âš¡ ç¬é–“ 1% çˆ†ç™¼ (è­¦å ±)</div>
            <div style="font-size:10px; color:#848e9c;">åƒ…é¡¯ç¤ºã€Œç•¶ä¸‹ã€çœŸæ­£å¸¶é‡æ‹‰å‡æ¨™çš„</div>
            <table><tbody id="instantBody"></tbody></table>
        </div>
        <div class="column">
            <div class="col-title">ğŸ”¥ å¼·å‹¢æ³¢æ®µç¶­æŒ</div>
            <table><tbody id="trendBody"></tbody></table>
        </div>
        <div class="column">
            <div class="col-title">ğŸ“ˆ ç¸®é‡ç›¤æ•´åŸ‹ä¼</div>
            <table><tbody id="sidewaysBody"></tbody></table>
        </div>
    </div>

    <audio id="alertSound" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <script>
        let priceMap = new Map(); // è¨˜éŒ„ä¸Šä¸€è¼ªåƒ¹æ ¼
        let prevInstant = new Set();
        let timeLeft = 5; // ç¸®çŸ­åˆ° 5 ç§’ï¼Œç‚ºäº†æŠ“å³æ™‚æ³¢å‹•

        async function run() {
            try {
                const tResp = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
                const tickers = await tResp.json();
                let instantRes = [], trendRes = [], sidewaysRes = [];
                let currentInstant = new Set();

                tickers.filter(t => t.symbol.endsWith('USDT') && !t.symbol.includes('_')).forEach(t => {
                    const symbol = t.symbol.replace('USDT', '');
                    const lastPrice = parseFloat(t.lastPrice);
                    const chg24h = parseFloat(t.priceChangePercent);
                    const vol24h = parseFloat(t.quoteVolume);
                    const high = parseFloat(t.highPrice), low = parseFloat(t.lowPrice);
                    const swing = (high - low) / low;
                    
                    // --- ä¿®æ­£æ ¸å¿ƒï¼šè¨ˆç®—ã€Œå³æ™‚è®Šå‹•ç‡ã€ ---
                    let realTimeChange = 0;
                    if (priceMap.has(symbol)) {
                        const oldPrice = priceMap.get(symbol);
                        realTimeChange = ((lastPrice - oldPrice) / oldPrice) * 100;
                    }
                    priceMap.set(symbol, lastPrice); // æ›´æ–°åƒ¹æ ¼ç´€éŒ„

                    const realBurst = (vol24h / 1440) > 0 ? (vol24h / 400) / (vol24h / 1440) : 0;

                    // 1. å™´ç™¼æ¬„ï¼šå¿…é ˆæ˜¯ã€Œå³æ™‚æ¼²å¹…ã€å¤§æ–¼ 0.8% ä¸”ã€Œçˆ†ç™¼åŠ›ã€å¼· (ä¸å†åªçœ‹ 24H)
                    if (realTimeChange >= 0.8 && realBurst > 3.0 && vol24h > 5000000) {
                        instantRes.push({ s: symbol, b: realBurst, c: realTimeChange, isNew: true });
                        currentInstant.add(symbol);
                    } 
                    // 2. è¶¨å‹¢æ¬„ï¼š24H å¼·å‹¢æ¨™çš„
                    else if (chg24h >= 5.0 && vol24h > 10000000) {
                        trendRes.push({ s: symbol, b: realBurst, c: chg24h });
                    }
                    // 3. ç›¤æ•´æ¬„
                    else if (Math.abs(chg24h) < 2.5 && swing < 0.2 && vol24h > 3000000) {
                        sidewaysRes.push({ s: symbol, b: realBurst, c: chg24h });
                    }
                });

                if (instantRes.length > 0) document.getElementById('alertSound').play().catch(()=>{});

                const render = (arr, isI) => arr.sort((a,b) => b.b - a.b).slice(0, 10).map(r => `
                    <tr class="${isI ? 'real-flash' : ''}">
                        <td class="symbol">${r.s}</td>
                        <td style="color:#02c076; font-weight:bold;">${r.b.toFixed(1)}x</td>
                        <td class="up">+${r.c.toFixed(2)}%</td>
                    </tr>`).join('');

                document.getElementById('instantBody').innerHTML = render(instantRes, true);
                document.getElementById('trendBody').innerHTML = render(trendRes, false);
                document.getElementById('sidewaysBody').innerHTML = render(sidewaysRes, false);
            } catch (e) { console.error(e); }
        }

        setInterval(() => { if (--timeLeft <= 0) { timeLeft=5; run(); } document.getElementById('timer').innerText = timeLeft + "s åˆ·æ–°"; }, 1000);
        run();
    </script>
</body>
</html>
